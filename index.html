<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>Grunt.js - the JavaScript Task Runner</title>

        <meta name="description" content="Presentation about Grunt.js - the JavaScript Task Runner">
        <meta name="author" content="Toon Ketels">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="css/reveal.min.css">
        <link rel="stylesheet" href="css/theme/default.css" id="theme">

        <!-- For syntax highlighting -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- If the query includes 'print-pdf', use the PDF print sheet -->
        <script>
            document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="reveal">

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">
<section>
  <h1>d3.js</h1>
  <h3>Data Driven Documents.</h3>
  <p><small><a href="http://twitter.com/toonketels">Toon Ketels</a></small></p>
</section>
<section>
  <h2>What is this about</h2>
  <ul>
    <li>SVG</li>
  </ul>
</section>
<section>
  <section>
    <h2>SVG</h2>
    <h4>Scalable Vector Graphics</h4>
  </section>
  <section>
    <h3>What are SVG?</h3>
    <blockquote>Scalable Vector Graphics (SVG) is an XML-based vector image format for two-dimensional graphics that has support for interactivity and animation. The SVG specification is an open standard developed by the World Wide Web Consortium (W3C) since 1999.</blockquote>
    <p><small><a href="http://en.wikipedia.org/wiki/Scalable_Vector_Graphics">Wikipedia</a></small></p>
  </section>
  <section>
    <h3>What we need to know</h3>
    <ul>
      <li>XML based - "tags and attributes"</li>
      <li>optimized for images - better for visualization</li>
    </ul>
  </section>
  <section>
    <h3>SVG elements</h3>
    <pre><code>
        <svg>
        <rect>
        <path>
        <circle>
        <text>
        </code></pre>
  </section>
  <section>
    <h3>SVG attributes</h3>
    <pre class="fragment"><code><rect x="0" width="5" y="0" height="50"></rect></code></pre>
    <pre class="fragment"><code><circle cx="100" cy="250" r="40"></circle></code></pre>
  </section>
</section>
<section>
  <section>
    <h2>SVG in the source</h2>
    <h4>1. Hardcoded into the HTML source</h4>
  </section>
  <section>
    <h2>SVG in the source</h2>
    <pre><code>
        <svg width="700" height="500">
          <rect x="0" width="5" y="0" height="50"></rect>
          <rect x="0" width="31" y="70" height="50"></rect>
          <rect x="0" width="86" y="140" height="50"></rect>
          <rect x="0" width="474" y="210" height="50"></rect>
          <rect x="0" width="308" y="280" height="50"></rect>
          <rect x="0" width="700" y="350" height="50"></rect>
          <rect x="0" width="630" y="420" height="50"></rect>
        </svg></code></pre>
  </section>
</section>
<section>
  <section>
    <h2>Insert SVG into DOM</h2>
    <h4>2. How to use d3 to create SVG element?</h4>
  </section>
  <section>
    <h2>How to use d3 to create SVG element?</h2>
    <pre><code>
        var canvas_d = {width: 700, height: 500},
        
        canvas = d3.select('#canvas').append('svg')
            .attr('width', canvas_d.width)
            .attr('height', canvas_d.height);
            </code></pre>
  </section>
  <section>
    <h2>How to use d3 to create SVG element?</h2>
    <pre><code>
        <div id="canvas">
          <svg width="700" height="500">
          </svg>
        </div></code></pre>
  </section>
</section>
<section>
  <section>
    <h2>Insert elements into SVG</h2>
    <h4>3. How to display content in SVG?</h4>
  </section>
  <section>
    <h2>Attempt one</h2>
    <h4 class="fragment">Iterate over each item in the data and append a `rect` element</h4>
  </section>
  <section>
    <h2>Source we want to generate</h2>
    <pre><code>
        <rect x="0" width="5" y="0" height="50"></rect>
        <rect x="0" width="31" y="70" height="50"></rect>
        <rect x="0" width="86" y="140" height="50"></rect>
        <rect x="0" width="474" y="210" height="50"></rect>
        <rect x="0" width="308" y="280" height="50"></rect>
        <rect x="0" width="700" y="350" height="50"></rect>
        <rect x="0" width="630" y="420" height="50"></rect>
        </code></pre>
  </section>
  <section>
    <h2>What changes?</h2>
    <ul class="fragment">
      <li>width</li>
      <li>y</li>
    </ul>
  </section>
  <section>
    <h2>What math do we need?</h2>
    <ul class="fragment">
      <li>y</li>
      <li>width</li>
    </ul>
  </section>
  <section>
    <h2>What math do we need?</h2>
    <pre class="fragment"><code>
        y = 70  * i
        </code></pre>
    <pre class="fragment"><code>
        width = canvas_d.width * (d/max_overall)
        </code></pre>
  </section>
  <section>
    <h3>Use d3 to calculate the overall max</h3>
    <pre><code>
        var data = [26009896, 179804755, 494478797, 2718505888, 1765686465, 4015692380, 3611612096],
        
        var max_overall = d3.max(data);
        </code></pre>
  </section>
  <section>
    <h3>All together now</h3>
    <pre><code>
        data.map(function(d, i) {
        
          canvas.append('rect')
           .attr('x', 0 )
           .attr('width', canvas_d.width * (d/max_overall))
           .attr('y', 70 * i)
           .attr('height', 50)
           
        });
        </code></pre>
  </section>
  <section>
    <h3>The same, written differently</h3>
    <pre><code>
        data.map(function(d, i) {
        
          canvas.append('rect')
           .attr('x', 0 )
           .attr('width', (function(d, i) {
             return canvas_d.width * (d/max_overall)
           })(d, i))
           .attr('y', (function(d, i) {
             return 70 * i;
           })(d, i))
           .attr('height', 50);
           
        });
        </code></pre>
  </section>
  <section>
    <h3>End result</h3>
    <pre><code>
        <svg width="700" height="500">
          <rect x="0" width="5" y="0" height="50"></rect>
          <rect x="0" width="31" y="70" height="50"></rect>
          <rect x="0" width="86" y="140" height="50"></rect>
          <rect x="0" width="474" y="210" height="50"></rect>
          <rect x="0" width="308" y="280" height="50"></rect>
          <rect x="0" width="700" y="350" height="50"></rect>
          <rect x="0" width="630" y="420" height="50"></rect>
        </svg>
        </code></pre>
  </section>
  <section>
    <h2>Attempt two</h2>
    <h4 class="fragment">Do it the d3 way with <strong>data-joins</strong></h4>
  </section>
  <section>
    <h2>How d3 wants us to do it</h2>
    <pre class="fragment"><code>
        canvas.selectAll('rect')
            .data( data )
        .enter().append('rect')
            .attr('x', 0 )
            .attr('width', function(d, i){
              return canvas_d.width * (d/max_overall);
            })
            .attr('y',  function(d, i) {
              return 70 * i;
            })
            .attr('height', 50)
            </code></pre>
  </section>
  <section>
    <h2>One by one</h2>
    <pre class="fragment"><code>
        canvas.selectAll('rect')
        </code></pre>
    <pre class="fragment"><code>
        .data( data )
        </code></pre>
    <pre class="fragment"><code>
        .enter()
        </code></pre>
    <pre class="fragment"><code>
        .append('rect')
            .attr('x', 0 )
            .attr('width', function(d, i){
              return canvas_d.width * (d/max_overall);
            })
            .attr('y',  function(d, i) {
              return 70 * i;
            })
            .attr('height', 50)
            </code></pre>
  </section>
  <section>
    <h2>How d3 wants us to do it</h2>
    <pre><code>
        canvas.selectAll('rect')
            .data( data )
        .enter().append('rect')
            .attr('x', 0)
            .attr('width', function(d, i){ return canvas_d.width * (d/max_overall) })
            .attr('y',  function(d, i) { return 70 * i })
            .attr('height', 50);
            </code></pre>
  </section>
  <section>
    <h2>What we need to remember from data joining</h2>
    <ul class="fragment">
      <li>We select items from within our SVG element</li>
      <li>We create a data joing with data( data )</li>
      <li>We can act on the existing or updated items</li>
      <li>We can act on new items, these should be created and appended</li>
      <li>We can act on old items, these should be removed</li>
    </ul>
  </section>
</section>
<section>
  <section>
    <h2>Data Joins</h2>
    <h4>Joining elements and data together</h4>
  </section>
  <section>
    <h2>What</h2>
    <ul>
      <li class="fragment">Collections of SVG elements can be joined with data to create new collections.</li>
      <li class="fragment">By calling some methods we can get sub collections</li>
    </ul>
    <pre class="fragment"><code>
        .enter()
        .exit()
        </code></pre>
  </section>
  <section>
    <h2>Our setup</h2>
    <pre><code>
        <svg width="700" height="500">
          <circle cx="100" cy="250" r="30"></circle>
          <circle cx="300" cy="250" r="30"></circle>
          <circle cx="500" cy="250" r="30"></circle>
          </code></pre>
  </section>
  <section>
    <h3>Select circles and join with data</h3>
    <pre><code>
        var data = [100, 200, 300, 400, 500, 600]
        
        var canvas = d3.select('svg');
        
        // Collection of elements joined with data
        var circles = canvas.selectAll('circle')
          .data( data );
          </code></pre>
  </section>
  <section>
    <h3>Act on current collection of elements</h3>
    <pre><code>
        var circles = canvas.selectAll('circle')
          .data( data );</code></pre>
    <pre class="fragment"><code>
        circles
          .attr('r', 40);</code></pre>
  </section>
  <section>
    <h3>Act on collection of new elements</h3>
    <pre><code>
        var circles = canvas.selectAll('circle')
          .data( data );
          
        circles
          .attr('r', 40);
          </code></pre>
    <pre class="fragment"><code>
        circles.enter().append('circle')
          .attr('cx', function(d, i){ return d })
          .attr('cy', 250)
          .attr('r', 0)
          .style('fill', 'green')
          .attr('r', 15);
          </code></pre>
  </section>
  <section>
    <h3>Act on current collection of items</h3>
    <pre><code>
        var circles = canvas.selectAll('circle')
          .data( data );
          
        circles
          .attr('r', 40);
          
        circles.enter().append('circle')
          .attr('cx', function(d, i){ return d })
          .attr('cy', 250)
          .attr('r', 0)
          .style('fill', 'green')
          .attr('r', 15);</code></pre>
    <pre class="fragment"><code>
        circles
          .style('fill', 'blue');
          </code></pre>
  </section>
  <section>
    <h3>Act on items to be removed</h3>
    <pre><code>
        var circles = canvas.selectAll('circle')
          .data( data );
          
        circles
          .attr('r', 40);
          
        circles.enter().append('circle')
          .attr('cx', function(d, i){ return d })
          .attr('cy', 250)
          .attr('r', 0)
          .style('fill', 'green')
          .attr('r', 15);
          
        circles
          .style('fill', 'blue');</code></pre>
    <pre class="fragment"><code>
        circles.exit()
          .attr('r', 5)
          .remove();
          </code></pre>
  </section>
  <section>
    <h3>Enter - update - exit pattern</h3>
    <pre><code>
        // Data binding
        var circles = canvas.selectAll('circle')
          .data( data );
          
        // Update
        circles.attr('r', 40);
        
        // Enter
        circles.enter().append('circle')
        
        // Update
        circles.style('fill', 'blue');
        
        // Exit
        circles.exit().remove();</code></pre>
  </section>
</section>
<section>
  <section> 
    <h2>Where were we?</h2>
    <pre class="fragment"><code>
        canvas.selectAll('rect')
            .data( data )
        .enter().append('rect')
            .attr('x', 0)
            .attr('width', function(d, i){ return canvas_d.width * (d/max_overall) })
            .attr('y',  function(d, i) { return 70 * i })
            .attr('height', 50);
            </code></pre>
  </section>
  <section> 
    <h2>What we have so far</h2>
    <ul class="fragment">
      <li>Insert SVG container (canvas)</li>
      <li>Create new elements via data binding</li>
      <li>Set attributes to those new items</li>
    </ul>
  </section>
</section>
<section>
  <section>
    <h2>Add margin</h2>
    <h4>4. Don't we need same space for labels and such?</h4>
  </section>
  <section>
    <h2>Create some dimensions</h2>
    <pre class="fragment"><code>canvas_d = {width: 700, height: 500},</code></pre>
    <pre class="fragment"><code>margin = {top: 50, right: 20, bottom: 20, left: 100},</code></pre>
    <pre class="fragment"><code>
        chart_d = {
          width: canvas_d.width -  margin.right - margin.left,
          height: canvas_d.height - margin.top - margin.bottom
        },</code></pre>
  </section>
  <section>
    <h2>Create the "chart"</h2>
    <pre class="fragment"><code>
        chart = canvas.append('g')
            .attr( 'transform', 'translate('+ margin.left +', '+ margin.top +')' )
              .attr( 'width' , chart_d.width)
              .attr('height', chart_d.height);
              </code></pre>
  </section>
  <section>
    <h2>Update bars drawing code</h2>
    <pre class="fragment"><code>
        chart.selectAll('rect')
            .data( data )
        .enter().append('rect')
            .attr('x', 0)
            .attr('width', function(d, i){ return chart_d.width * (d/max_overall) })
            .attr('y',  function(d, i) { return 60 * i })
            .attr('height', 50)</code></pre>
  </section>
</section>
<section>
  <section>
    <h2>Linear scales</h2>
    <h4>5. I hate the math in our code, can't we use scales for that?</h4>
  </section>
  <section>
    <h2>Linear scales</h2>
    <pre><code>
        attr('width', function(d, i){ return chart_d.width * (d/max_overall) })
        </code></pre>
  </section>
  <section>
    <h2>3 types of scales</h2>
    <ul>
      <li>time scale - for time domains.</li>
      <li>ordinal scales -  for discrete input domains, such as names or categories.</li>
      <li>quantitative scales - for continuous input domains, such as numbers.</li>
    </ul>
  </section>
  <section>
    <h3>A scale convert some input into some output</h3>
    <pre class="fragment"><code>attr('width', function(d, i){ return chart_d.width * (d/max_overall) })</code></pre>
    <pre class="fragment"><code>
        width:  data => pixels
        </code></pre>
  </section>
  <section>
    <h3>Input domain</h3>
    <pre class="fragment"><code>
        var data = [26009896, 
                   179804755, 
                   494478797, 
        2718505888, 
                  1765686465, 
                  4015692380, 
                  3611612096];
                  </code></pre>
  </section>
  <section>
    <h3>Output</h3>
    <pre class="fragment"><code>
        <rect x="0" width="5" y="0" height="50"></rect>
        <rect x="0" width="31" y="70" height="50"></rect>
        <rect x="0" width="86" y="140" height="50"></rect>
        <rect x="0" width="474" y="210" height="50"></rect>
        <rect x="0" width="308" y="280" height="50"></rect>
        <rect x="0" width="700" y="350" height="50"></rect>
        <rect x="0" width="630" y="420" height="50"></rect>
        </code></pre>
  </section>
  <section>
    <h3>Conversion</h3>
    <pre class="fragment"><code>
        26009896           =>              5
        179804755          =>             31
        494478797          =>             86
        2718505888         =>            474
        1765686465         =>            308
        4015692380         =>            700
        3611612096         =>            630
        </code></pre>
  </section>
  <section>
    <h3>Scale function</h3>
    <pre class="fragment"><code>
        var width = scaleFunc(179804755)     // 31
        </code></pre>
  </section>
  <section>
    <h2>How to create a scalefunction?</h2>
  </section>
  <section>
    <h3>First, create scale</h3>
    <pre class="fragment"><code>
        x = d3.scale.linear()
          .domain([0, max_overall])
          .range([0, chart_d.width]);
          </code></pre>
  </section>
  <section>
    <h3>Use it</h3>
    <pre class="fragment"><code>
        chart.selectAll('rect')
            .data( data )
        .enter().append('rect')
            .attr('x', 0)
            .attr('width', function(d, i){ return x(d) })
            .attr('y',  function(d, i) { return 60 * i })
            .attr('height', 50);
            </code></pre>
  </section>
  <section>
    <h3>In short</h3>
    <pre class="fragment"><code>
        chart.selectAll('rect')
            .data( data )
        .enter().append('rect')
            .attr('x', 0)
            .attr('width', x)
            .attr('y',  function(d, i) { return 60 * i })
            .attr('height', 50);</code></pre>
  </section>
</section>
<section>
  <h2>meta</h2>
</section>
<section>
  <h2>Thanks</h2>
  <h4>Toon Ketels</h4>
  <p>
    <small><a href="http://twitter.com/toonketels">@toonketels</a></small>
    
    
    
  </p>
</section>            </div>

        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.min.js"></script>

        <script>

            // Full list of configuration options available here:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,

                theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
                transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

                // Optional libraries used to extend on reveal.js
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
                    { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
                    // { src: 'plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } }
                    // { src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
                ]
            });

        </script>

    </body>
</html>
